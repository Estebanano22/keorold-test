<!-- Header -->
<%- include('layautsDashboard/header') %>

<body class="main-body leftmenu body-ingreso">

    <%- include('layautsDashboard/loader') %>

		<!-- Page -->
		<div class="page">

			<!-- Menu -->
			<%- include('layautsDashboard/menu') %> 

			<!-- Cabecera -->
			<%- include('layautsDashboard/head') %> 

			<!-- Main Content-->
			<div class="main-content side-content pt-0">

				<div class="container-fluid">
					<div class="inner-body">

						<!-- Page Header -->
						<div class="page-header">
							<div>
								<h2 class="main-content-title tx-24 mg-b-5"><%- titulo %></h2>
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a href="/dashboard/inicio">Inicio</a></li>
									<li class="breadcrumb-item active" aria-current="page"><%- breadcrumb %></li>
								</ol>
							</div>
						</div>
						<!-- End Page Header -->

						<!-- =============================
							Inicio Componentes Pagina
						============================== -->
						
						<!-- Row -->
						<div class="row row-sm">
                            <div class="col-sm-6 col-md-6 col-xl-2">
								<div class="card custom-card">
									<div class="card-body text-center">
										<div class="icon-service bg-success-transparent rounded-circle text-success">
											<i class="fe fe-upload-cloud"></i>
										</div>
										<p class="mb-1 text-muted">Total<br>Cuentas Vendidas</p>
										<h3 class="mb-0"><%= cuentas.length %></h3>
									</div>
								</div>
							</div>
							<div class="col-sm-6 col-md-6 col-xl-2">
								<div class="card custom-card">
									<div class="card-body text-center">
										<div class="icon-service bg-primary-transparent rounded-circle text-primary">
											<i class="fe fe-airplay"></i>
										</div>
										<p class="mb-1 text-muted">Cuentas<br>normales</p>
										<h3 class="mb-0"><%= cuentasNormales %></h3>
									</div>
								</div>
							</div>
							<div class="col-sm-6 col-md-6 col-xl-2">
								<div class="card custom-card">
									<div class="card-body text-center">
										<div class="icon-service bg-secondary-transparent rounded-circle text-secondary">
											<i class="fe fe-airplay"></i>
										</div>
										<p class="mb-1 text-muted">Cuentas<br>bajo pedido</p>
										<h3 class="mb-0"><%= cuentasBajoPedido %></h3>
									</div>
								</div>
							</div>
							<div class="col-sm-6 col-md-6 col-xl-2">
								<div class="card custom-card">
									<div class="card-body text-center">
										<div class="icon-service bg-danger-transparent rounded-circle text-danger">
											<i class="fe fe-airplay"></i>
										</div>
										<p class="mb-1 text-muted">Cuentas<br>personalizadas</p>
										<h3 class="mb-0"><%= cuentasPersonalizadas %></h3>
									</div>
								</div>
							</div>
                            <div class="col-sm-6 col-md-6 col-xl-2">
								<div class="card custom-card">
									<div class="card-body text-center">
										<div class="icon-service bg-info-transparent rounded-circle text-info">
											<i class="fe fe-airplay"></i>
										</div>
										<p class="mb-1 text-muted">Cuentas<br>renovaciones</p>
										<h3 class="mb-0"><%= cuentasRenovaciones %></h3>
									</div>
								</div>
							</div>
                            <div class="col-sm-6 col-md-6 col-xl-2">
								<div class="card custom-card">
									<div class="card-body text-center">
										<div class="icon-service bg-warning-transparent rounded-circle text-warning">
											<i class="fe fe-airplay"></i>
										</div>
										<p class="mb-1 text-muted">Cuentas<br>juegos</p>
										<h3 class="mb-0"><%= cuentasJuegos %></h3>
									</div>
								</div>
							</div>
                            
						</div>
						<!-- End Row -->

						<!-- Row -->
						<div class="row row-sm">
							<div class="col-lg-12">
								<div class="card custom-card">
									<div class="card-body">
										<div>
											<h6 class="main-content-label mb-1">Total cuentas vendidas en red</h6>
											<p class="text-muted card-sub-title">A continuaci√≥n encontrara un reporte detallado de todas las cuentas vendidas en su red.</p>
										</div>
										<div class="table-responsive">
											<table class="table table-bordered text-nowrap w-100 key-buttons" id="exportexample">
												<thead>
													<tr>
														<th>Logo</th>
                                                        <th>Plataforma</th>
														<th>Valor pagado</th>
                                                        <th>Tipo plataforma</th>
														<th>Usuario</th>
                                                        <th>Password</th>
                                                        <th>Pantalla</th>
                                                        <th>Pin</th>
                                                        <th>Fecha Compra</th>
														<th>Fecha Subida</th>
													</tr>
												</thead>
												<tbody>
                                                    <% moment.locale('es'); %>
													<% if(cuentas.length) { %> 
														<% cuentas.forEach(listaCuentas => { %>
															<% if(listaCuentas.usuario.pais === 'Colombia') { %>
																<% var valorFormateado = new Intl.NumberFormat("es-CO", {style: "currency", currency: "COP", maximumSignificantDigits: 3}).format(listaCuentas.valorPagado); %>
															<% } else { %>
																<% var valorFormateado = new Intl.NumberFormat("en-US", {style: "currency", currency: "USD"}).format(listaCuentas.valorPagado); %>
															<% } %>
															<tr>
																<td class="text-center">
																	<img src="<%= listaCuentas.plataforma.logo === null ? '/assetsDashboard/img/users/default.jpg' : '/uploads/plataformas/' + listaCuentas.plataforma.logo %>" alt="" class="img-circle">
																</td>
																<td class="text-capitalize"><%= listaCuentas.plataforma.plataforma %></td>
																<td class="text-capitalize text-right"><%= valorFormateado %></td>
																<td class="text-capitalize text-center">
                                                                    <span class="badge <%= listaCuentas.plataforma.tipo_plataforma === 1 ? 'badge-primary' : listaCuentas.plataforma.tipo_plataforma === 2 ? 'badge-secondary' : listaCuentas.plataforma.tipo_plataforma === 3 ? 'badge-danger' : listaCuentas.plataforma.tipo_plataforma === 4 ? 'badge-info' : listaCuentas.plataforma.tipo_plataforma === 5 ? 'badge-warning' : 'badge-light' %>">
                                                                        <%= listaCuentas.plataforma.tipo_plataforma === 1 ? 'Normal' : listaCuentas.plataforma.tipo_plataforma === 2 ? 'Bajo Pedido' : listaCuentas.plataforma.tipo_plataforma === 3 ? 'Personalizada' : listaCuentas.plataforma.tipo_plataforma === 4 ? 'Renovaciones' : listaCuentas.plataforma.tipo_plataforma === 5 ? 'Juegos' : 'N/A' %>
                                                                    </span>
                                                                </td>
                                                                <td class="text-left"><%= listaCuentas.user %></td>
                                                                <td class="text-left"><%= listaCuentas.password %></td>
                                                                <td class="text-left"><%= listaCuentas.pantalla %></td>
                                                                <td class="text-left"><%= listaCuentas.pin %></td>
                                                                <td class="text-center"><%= moment(listaCuentas.fechaCompra).format('MMMM Do YYYY, h:mm:ss a') %></td>
                                                                <td class="text-center"><%= moment(listaCuentas.fechaSubida).format('MMMM Do YYYY, h:mm:ss a') %></td>
															</tr>
														<% }) %> 
													<% } %> 
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
						</div>
						<!-- End Row -->

						<!-- =============================
							Fin Componentes Pagina
						============================== -->

					</div>
				</div>
			</div>
			<!-- End Main Content-->

			<!-- Foot -->
			<%- include('layautsDashboard/foot') %> 

			<!-- Notificiaciones -->
			<%- include('layautsDashboard/notificaciones') %>

		</div>
		<!-- End Page -->


<!-- Footer -->
<%- include('layautsDashboard/footer') %> 


<!-- Scripts Personalizados -->

<% if(locals.mensajes) { %>
	<% const validacionErrores = Object.keys(locals.mensajes) %>
	<% if(validacionErrores.length) { %>
		
		<% locals.mensajes[validacionErrores].forEach(alerta => { %>

			<% if(validacionErrores == 'error') { %>
				<% title = 'Lo Sentimos!' %> 
			<% } else if (validacionErrores == 'success') { %>
				<% title = 'Perfecto!' %> 
			<% } %> 

			<script>
				swal(
					{
						title: "<%= title %>",
						text: "<%= alerta %>",
						type: "<%= validacionErrores %>",
						confirmButtonColor: '#57a94f'
					}
				)
			</script>

		<% }); %>

	<% } %> 
<% } %>